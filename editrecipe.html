<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Recipe</title>
    <link rel="stylesheet" href="Styles.css">
</head>

<body>
    <header>
        <h1>Edit Recipe</h1>
    </header>

    <nav>
        <a href="recipeslist.html">Back</a>
    </nav>

    <form id="editRecipeForm">
        <label for="recipeName">Recipe Name:</label><br>
        <input type="text" id="recipeName" name="recipeName"><br>

        <div id="ingredientDetailsContainer"></div>

        <button type="submit">Save Changes</button>
    </form>

    <script>
        const recipeID = new URLSearchParams(window.location.search).get('recipeID');

        window.onload = function () {
            fetch(`DatabaseGetRecipe.php?recipeID=${recipeID}`)
                .then(response => response.json())
                .then(data => {
                    document.getElementById('recipeName').value = data.Recipe_Name;

                    const ingredientDetailsContainer = document.getElementById('ingredientDetailsContainer');
                    const ingredientDetails = data.Ingredients_Details.split(',');
                    ingredientDetails.forEach(ingredientDetail => {
                        const [name, unit, amount, price] = ingredientDetail.trim().split(' ');
                        const nameLabel = document.createElement('label');
                        nameLabel.textContent = 'Ingredient Name:';
                        const nameInput = document.createElement('input');
                        nameInput.type = 'text';
                        nameInput.value = name;
                        const unitLabel = document.createElement('label');
                        unitLabel.textContent = 'Unit:';
                        const unitInput = document.createElement('input');
                        unitInput.type = 'text';
                        unitInput.value = unit;
                        const amountLabel = document.createElement('label');
                        amountLabel.textContent = 'Amount:';
                        const amountInput = document.createElement('input');
                        amountInput.type = 'text';
                        amountInput.value = amount;
                        const priceLabel = document.createElement('label');
                        priceLabel.textContent = 'Price:';
                        const priceInput = document.createElement('input');
                        priceInput.type = 'text';
                        priceInput.value = price;
                        ingredientDetailsContainer.appendChild(nameLabel);
                        ingredientDetailsContainer.appendChild(nameInput);
                        ingredientDetailsContainer.appendChild(unitLabel);
                        ingredientDetailsContainer.appendChild(unitInput);
                        ingredientDetailsContainer.appendChild(amountLabel);
                        ingredientDetailsContainer.appendChild(amountInput);
                        ingredientDetailsContainer.appendChild(priceLabel);
                        ingredientDetailsContainer.appendChild(priceInput);
                        ingredientDetailsContainer.appendChild(document.createElement('br'));
                    });
                })
                .catch(error => console.error('Error fetching recipe details:', error));
        };

        document.getElementById('editRecipeForm').addEventListener('submit', function (event) {
            event.preventDefault();

            const formData = new FormData(this);

            fetch('DatabaseUpdateRecipe.php', {
                method: 'POST',
                body: formData
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Failed to update recipe');
                    }
                    return response.json();
                })
                .then(data => {
                    console.log(data.message);
                    window.location.href = "recipeslist.html";
                })
                .catch(error => console.error('Error updating recipe:', error));
        });
    </script>
</body>

</html>











